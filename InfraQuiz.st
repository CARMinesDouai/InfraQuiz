WAComponent subclass: #InfraQuiz	instanceVariableNames: 'texte resultat'	classVariableNames: ''	poolDictionaries: ''	category: 'InfraQuiz'!!InfraQuiz commentStamp: 'MaxenceGodefert 4/30/2019 22:20' prior: 0!InfraQuiz est (pour le moment) une application qui permet d'exécuter du code Pharo depuis une page web et d'afficher le résultat de cette exécution.Cette application est réalisée dans le cadre d'un PDR et permettra à terme de réaliser un QUIZ où on peut saisir du code pour répondre à une question.Variables d'instances :	texte: <OrderedCollection<ByteString>>	resultat: <ByteString>	texte 	- Ensemble du code écrit, par défaut contient un String vide.	resultat	- Résultat de la dernière exécution (Correspond au printIt)!!InfraQuiz methodsFor: 'content' stamp: 'MaxenceGodefert 4/30/2019 22:05'!renderContentOn: html	html form: [		html text: 'Entrez du code Pharo'.		html break.		html textInput			callback: [ :value | 				self ajoutCode: value.				self executerCode.				].		html break.      html submitButton.	].	html anchor		callback: [ self resetCode ];		with: 'Reset'.	html break.	(texte) ifNotNil: [		html text: 'Votre code écrit : '.		(self texte) do:[:element|			html text: element.			html break.			].		].	html break.	(self resultat) ifNotNil: [		html text: 'Le résultat de votre dernière exécution : '.		html break.		html text: self resultat.		].! !!InfraQuiz methodsFor: 'content' stamp: 'MaxenceGodefert 4/30/2019 22:27'!executerCode	"Exécute tout le code de notre collection. 	En cas d'erreur, il remplit la variable résultat avec l'erreur pour qu'elle ne bloque pas l'application."	[self resultat: (AbstractCompiler evaluate: (self toutNotreCode))] on: Error do: [ :e | self resultat: ('Oops!! ' , e className , '!!') ].! !!InfraQuiz methodsFor: 'content' stamp: 'MaxenceGodefert 4/30/2019 22:27'!updateRoot: anHtmlRoot	"head de notre page"	super updateRoot: anHtmlRoot.	anHtmlRoot beHtml5.	anHtmlRoot title: 'InfraQuiz'.! !!InfraQuiz methodsFor: 'accessing' stamp: 'MaxenceGodefert 4/30/2019 22:21'!resultat	^ resultat! !!InfraQuiz methodsFor: 'accessing' stamp: 'MaxenceGodefert 4/30/2019 22:30'!texte	"On crée l'OrderedCollection si elle n'est pas initialisé. On ajoute une chaine vide afin qu'on ait bien une collection de ByteString."	texte ifNil: [		self texte: OrderedCollection new.		texte add: ''.		].	^ texte! !!InfraQuiz methodsFor: 'accessing' stamp: 'MaxenceGodefert 3/24/2019 14:36'!texte: anObject	texte := anObject! !!InfraQuiz methodsFor: 'accessing' stamp: 'MaxenceGodefert 4/30/2019 16:28'!resultat: anObject	resultat := anObject! !!InfraQuiz methodsFor: 'collectionCode' stamp: 'MaxenceGodefert 4/30/2019 22:24'!resetCode	"On supprime tout ce qu'on a saisi"	self texte: nil.	self resultat: nil.! !!InfraQuiz methodsFor: 'collectionCode' stamp: 'MaxenceGodefert 4/30/2019 22:23'!ajoutCode:value	"Lorsqu'une instruction Pharo est écrite, on l'ajoute à notre ensemble de code à exécuter et on ajoute un . pour assurer la fin de la ligne saisie."	(self texte) add: value,'.'.! !!InfraQuiz methodsFor: 'collectionCode' stamp: 'MaxenceGodefert 4/30/2019 22:25'!toutNotreCode	"Parcourt notre collection d'instruction et concatène les éléments en une seule Chaine de Charactères."	|codeFinal|	codeFinal:=''.	(self texte) do: [ :element | codeFinal:=codeFinal,element ].	^codeFinal.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!InfraQuiz class	instanceVariableNames: ''!!InfraQuiz class methodsFor: 'acccessing' stamp: 'MaxenceGodefert 3/24/2019 14:01'!description	^'Un site de quiz pour apprendre à programmer'.! !!InfraQuiz class methodsFor: 'acccessing' stamp: 'MaxenceGodefert 3/24/2019 14:08'!handlerName	^'InfraQuiz'! !!InfraQuiz class methodsFor: 'initialization' stamp: 'MaxenceGodefert 3/23/2019 21:49'!canBeRoot	^true.! !!InfraQuiz class methodsFor: 'initialization' stamp: 'MaxenceGodefert 4/30/2019 15:54'!initialize"self initialize"| app |app := WAAdmin register: self asApplicationAt: self handlerName.app addLibrary: JQDeploymentLibrary.app addLibrary: JQUiDeploymentLibrary.app addLibrary: TBSDeploymentLibrary.! !InfraQuiz initialize!