Object subclass: #CodeExecutor	instanceVariableNames: 'code'	classVariableNames: ''	poolDictionaries: ''	category: 'InfraQuiz'!!CodeExecutor methodsFor: 'execution' stamp: 'MaxenceGodefert 5/6/2019 18:32'!evalCode	self subclassResponsibility.! !!CodeExecutor methodsFor: 'accessing' stamp: 'MaxenceGodefert 5/6/2019 18:28'!code: anObject	code := anObject! !!CodeExecutor methodsFor: 'accessing' stamp: 'MaxenceGodefert 5/6/2019 18:28'!code	^ code! !WAComponent subclass: #InfraQuiz	instanceVariableNames: 'result oldCode children main'	classVariableNames: ''	poolDictionaries: ''	category: 'InfraQuiz'!!InfraQuiz commentStamp: 'MaxenceGodefert 5/6/2019 18:20' prior: 0!InfraQuiz is (at the moment) an application that lets you run Pharo code from a web page and display the result of this execution.This application is made as part of a PDR and will eventually make a QUIZ where you can enter code to answer a question.Instance variables :	result: <ByteString>	result	- Result of the last run (Corresponds to the printIt)!!InfraQuiz methodsFor: 'testing' stamp: 'LucFabresse 5/6/2019 11:12'!hasResult	^ self result notNil! !!InfraQuiz methodsFor: 'content' stamp: 'AlejandraAcevedo 5/8/2019 00:22'!renderContentOn: htmlhtml render: main.html tbsContainer	with: [ 	html tbsForm: [		html tbsFormGroup: [ 			html label for: 'inputCode'; with: 'Your Code:'.			html textArea 				style: 'width: 60%; height: 200px';				callback: [ :code | self executeCode: code ];				tbsFormControl; 				id: 'exampleInputEmail1'; 				text: self oldCode.		].					html tbsSubmitButton 			bePrimary;			with: 'Execute'.		html space.		html tbsButton			beDefault;			callback: [ self resetResult ];			with: 'Reset'.	].		html div		class: 'spacer';		style: 'height: 50px'.		self hasResult ifTrue: [ 		html heading level:4; with: 'Output:'.		html textArea 			style: 'width: 60%; height: 200px';			text: self result	]]! !!InfraQuiz methodsFor: 'actions' stamp: 'MaxenceGodefert 5/8/2019 15:58'!executeCode: code	|input|	self oldCode: code.	(PharoExecutor new:code) evalCode.	"input := 'in.st' asFileReference.	input writeStreamDo: [ :stream | stream nextPutAll: code ].	PharoExecutor executeFromFile."	self result: ('out.txt' asFileReference readStream upToEnd).! !!InfraQuiz methodsFor: 'actions' stamp: 'MaxenceGodefert 5/6/2019 18:59'!resetResult	self result: nil.	self oldCode: nil.! !!InfraQuiz methodsFor: 'accessing' stamp: 'AlejandraAcevedo 5/8/2019 00:11'!children	^ {children}! !!InfraQuiz methodsFor: 'accessing' stamp: 'LucFabresse 5/6/2019 11:15'!result	^ result! !!InfraQuiz methodsFor: 'accessing' stamp: 'AlejandraAcevedo 5/8/2019 00:13'!children: anObject	children := anObject! !!InfraQuiz methodsFor: 'accessing' stamp: 'MaxenceGodefert 5/6/2019 19:16'!oldCode	oldCode ifNil: [ oldCode := '10  factorial' ].	^ oldCode! !!InfraQuiz methodsFor: 'accessing' stamp: 'LucFabresse 5/6/2019 11:15'!result: anObject	result := anObject! !!InfraQuiz methodsFor: 'accessing' stamp: 'MaxenceGodefert 5/6/2019 18:57'!oldCode: anObject	oldCode := anObject! !!InfraQuiz methodsFor: 'initialization' stamp: 'AlejandraAcevedo 5/8/2019 00:11'!initialize 	super initialize.	main := TBScreenComponent new .	result := nil! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!InfraQuiz class	instanceVariableNames: ''!!InfraQuiz class methodsFor: 'initialization' stamp: 'LucFabresse 5/6/2019 10:37'!canBeRoot	^true! !!InfraQuiz class methodsFor: 'initialization' stamp: 'MaxenceGodefert 4/30/2019 15:54'!initialize"self initialize"| app |app := WAAdmin register: self asApplicationAt: self handlerName.app addLibrary: JQDeploymentLibrary.app addLibrary: JQUiDeploymentLibrary.app addLibrary: TBSDeploymentLibrary.! !!InfraQuiz class methodsFor: 'as yet unclassified' stamp: 'AlejandraAcevedo 5/8/2019 00:09'!description|aDescription|aDescription := 'Un site de quiz pour apprendre à programmer developpé par des étudiants de L'+'IMT Lille-Douai'.	^aDescription.! !!InfraQuiz class methodsFor: 'acccessing' stamp: 'MaxenceGodefert 3/24/2019 14:08'!handlerName	^'InfraQuiz'! !CodeExecutor subclass: #PharoExecutor	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'InfraQuiz'!!PharoExecutor methodsFor: 'execution' stamp: 'MaxenceGodefert 5/8/2019 16:09'!evalCode	|temp temp2|	temp:=(self code) copyReplaceAll: (String cr) with: ''.	temp2:=temp copyReplaceAll: (String lf) with: ''.	Transcript show:'./pharo Pharo.image eval ',temp2,' > out.txt' ;cr.	OSProcess waitForCommand: './pharo Pharo.image eval ',temp2,' > out.txt'.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!PharoExecutor class	instanceVariableNames: ''!!PharoExecutor class methodsFor: 'execution' stamp: 'MaxenceGodefert 5/6/2019 20:21'!executeFromFile	OSProcess waitForCommand: './pharo Pharo.image st --quit in.st > out.txt'.! !!PharoExecutor class methodsFor: 'initialization' stamp: 'MaxenceGodefert 5/6/2019 18:30'!new:code	|executor|	executor := PharoExecutor new.	executor code:code.	^executor.! !WAComponent subclass: #TBButtonComponent	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'InfraQuiz'!WAComponent subclass: #TBHeaderComponent	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'InfraQuiz'!!TBHeaderComponent methodsFor: 'as yet unclassified' stamp: 'AlejandraAcevedo 5/8/2019 00:09'!renderBrandOn: htmlhtml tbsNavbarHeader: [html tbsNavbarBrandurl: self application url;with: self class description ]! !!TBHeaderComponent methodsFor: 'rendering' stamp: 'AlejandraAcevedo 5/8/2019 00:09'!renderContentOn: htmlhtml tbsNavbar beDefault with: [html tbsNavbarBrandurl: '#';with: self class description ]! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!TBHeaderComponent class	instanceVariableNames: ''!!TBHeaderComponent class methodsFor: 'as yet unclassified' stamp: 'AlejandraAcevedo 5/8/2019 00:18'!description|aDescription|aDescription := 'Un site de quiz pour apprendre à programmer'.	^aDescription.! !WAComponent subclass: #TBScreenComponent	instanceVariableNames: 'header'	classVariableNames: ''	poolDictionaries: ''	category: 'InfraQuiz'!!TBScreenComponent methodsFor: 'initialization' stamp: 'AlejandraAcevedo 5/8/2019 00:13'!initialize super initialize.header := TBHeaderComponent new.! !!TBScreenComponent methodsFor: 'as yet unclassified' stamp: 'AlejandraAcevedo 5/8/2019 00:11'!renderContentOn: htmlhtml render: header.! !!TBScreenComponent methodsFor: 'as yet unclassified' stamp: 'AlejandraAcevedo 5/8/2019 00:11'!createHeaderComponent   ^TBHeaderComponent new! !!TBScreenComponent methodsFor: 'as yet unclassified' stamp: 'AlejandraAcevedo 5/8/2019 00:11'!children^ OrderedCollection with: header! !InfraQuiz initialize!